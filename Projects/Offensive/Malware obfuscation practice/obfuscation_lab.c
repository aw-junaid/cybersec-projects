/*
Malware Obfuscation Practice (C version)
Educational obfuscation demonstration.
Compile: gcc obfuscation_lab.c -o obfuscation_lab
*/

#include <stdio.h>
#include <string.h>
#include <stdlib.h>

void xor_encrypt(char *data, char *key, char *output) {
    int len = strlen(data);
    int klen = strlen(key);
    for (int i = 0; i < len; i++) {
        output[i] = data[i] ^ key[i % klen];
    }
    output[len] = '\0';
}

void base64_encode(const unsigned char *data, int input_length, char *output);
void base64_decode(const char *data, unsigned char *output);

int main() {
    char text[512], key[128], output[512];
    int choice;

    printf("=== Malware Obfuscation Practice (C) ===\n");
    printf("1. XOR Encrypt\n2. XOR Decrypt\n3. Exit\n");

    printf("Select option: ");
    scanf("%d", &choice);
    getchar();

    if (choice == 1) {
        printf("Enter text: ");
        fgets(text, sizeof(text), stdin);
        text[strcspn(text, "\n")] = 0;
        printf("Enter key: ");
        fgets(key, sizeof(key), stdin);
        key[strcspn(key, "\n")] = 0;

        xor_encrypt(text, key, output);
        printf("[+] XOR Encrypted Output (raw): %s\n", output);
    } else if (choice == 2) {
        printf("Enter text: ");
        fgets(text, sizeof(text), stdin);
        text[strcspn(text, "\n")] = 0;
        printf("Enter key: ");
        fgets(key, sizeof(key), stdin);
        key[strcspn(key, "\n")] = 0;

        xor
