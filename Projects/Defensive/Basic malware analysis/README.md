# Basic Malware Analysis Sandbox

### What the Tool Is For:
This sandbox provides a controlled environment to safely execute and analyze malware samples while monitoring their behavior, system interactions, and network activity without risking the host system.

### About:
Malware analysis sandboxes are essential for understanding malware behavior, extracting indicators of compromise (IOCs), and developing detection signatures. They provide isolation and monitoring capabilities to observe malware in action safely.


## How to Run the Code

### Python Version:
```bash
# Install dependencies
pip3 install psutil python-magic

# Analyze a sample
python3 malware_sandbox.py suspicious_file.exe

# With custom timeout and output
python3 malware_sandbox.py malware.py -t 30 -o report.json

# Keep temporary files for further analysis
python3 malware_sandbox.py sample.bin --no-cleanup
```

### C Version:
```bash
# Compile with OpenSSL
gcc -o malware_sandbox malware_sandbox.c -lssl -lcrypto

# Analyze a sample
./malware_sandbox suspicious_file.exe

# With custom timeout
./malware_sandbox malware.py 30
```

---

## Algorithm Explanation

### How the Malware Sandbox Works:

**Pre-Execution Analysis:**
1. **File Hashing** - Calculate MD5, SHA1, SHA256 for identification
2. **Entropy Analysis** - Detect encryption/packing through randomness
3. **String Extraction** - Find URLs, IPs, domains, and suspicious keywords
4. **File Type Detection** - Determine executable format and properties

**Execution Monitoring:**
1. **Process Monitoring** - Track process creation, parent-child relationships
2. **Network Monitoring** - Capture connections, protocols, remote endpoints
3. **File System Monitoring** - Watch for file creations, modifications, deletions
4. **Registry Monitoring** - Track Windows registry changes (simulated)

**Behavioral Analysis:**
1. **Process Tree Analysis** - Map execution chains and relationships
2. **Network Behavior** - Identify C2 communications and data exfiltration
3. **Persistence Mechanisms** - Detect auto-start entries and services
4. **Evasion Techniques** - Identify anti-analysis and sandbox detection

**IOC Extraction:**
1. **Network IOCs** - IP addresses, domains, URLs
2. **File IOCs** - File paths, hashes, names
3. **Behavioral IOCs** - Suspicious activities and patterns
4. **Memory IOCs** - Injected code, unpacked payloads

**Verdict Generation:**
- **Scoring System** - Weighted scoring based on suspicious activities
- **Confidence Levels** - High/Medium/Low based on evidence strength
- **Threat Classification** - Malicious/Suspicious/Clean
