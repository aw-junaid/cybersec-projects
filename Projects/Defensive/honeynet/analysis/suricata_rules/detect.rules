# Honeynet Suricata Rules
# Safety: For lab monitoring only

# SSH brute force detection
alert tcp any any -> any 22 (msg:"SSH brute force attempt"; flow:established,to_server; content:"SSH-"; depth:4; threshold: type threshold, track by_src, count 5, seconds 60; sid:1000001; rev:1;)

# Web scanner detection  
alert http any any -> any any (msg:"Web vulnerability scanner detected"; http.user_agent; content:"nikto"; nocase; sid:1000002; rev:1;)
alert http any any -> any any (msg:"Web vulnerability scanner detected"; http.user_agent; content:"sqlmap"; nocase; sid:1000003; rev:1;)
alert http any any -> any any (msg:"Web vulnerability scanner detected"; http.user_agent; content:"w3af"; nocase; sid:1000004; rev:1;)

# Suspicious User-Agents
alert http any any -> any any (msg:"Suspicious User-Agent"; http.user_agent; content:"curl"; nocase; sid:1000005; rev:1;)
alert http any any -> any any (msg:"Suspicious User-Agent"; http.user_agent; content:"wget"; nocase; sid:1000006; rev:1;)

# Webshell upload attempts
alert http any any -> any any (msg:"Potential webshell upload"; http.uri; content:".php"; content:"cmd"; distance:0; sid:1000007; rev:1;)
alert http any any -> any any (msg:"Potential webshell upload"; http.uri; content:".jsp"; content:"password"; distance:0; sid:1000008; rev:1;)

# C2 beaconing patterns
alert dns any any -> any any (msg:"Suspicious DNS query - likely beaconing"; dns.query; content:".ddns.net"; nocase; sid:1000009; rev:1;)
alert dns any any -> any any (msg:"Suspicious DNS query - likely beaconing"; dns.query; content:".duckdns.org"; nocase; sid:1000010; rev:1;)

# File transfer detection
alert tcp any any -> any any (msg:"Large file transfer detected"; flow:established; app_layer_bytes.toserver > 10485760; sid:1000011; rev:1;)

# Industrial protocol anomalies
alert tcp any any -> any 502 (msg:"Modbus exception response"; content:"|81|"; depth:1; sid:1000012; rev:1;)
alert tcp any any -> any 502 (msg:"Modbus function code scan"; content:"|00 00 00 00 00 06|"; depth:6; sid:1000013; rev:1;)
